name: Build and deploy
on:
  push:
    branches:
      - master
jobs:
  Build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Clone repository
        run: |
          git clone https://github.com/${{ github.repository }} .
      - name: Check out branch
        run: |
          GITHUB_REF="${{ github.ref }}"
          ARRAY=(${GITHUB_REF//\// })
          BRANCH_NAME=${ARRAY[2]}
          CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
          if [ $BRANCH_NAME != $CURRENT_BRANCH ]; then
            echo "Start to fetch origin/$BRANCH_NAME"
            git fetch origin $BRANCH_NAME
            git checkout $BRANCH_NAME
          else
            echo "Current branch is $CURRENT_BRANCH."
          fi
      - name: Build
        run: echo $(git rev-parse --abbrev-ref HEAD)
      - run: echo "deploy"
